<html>
  <head>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="https://platinumos.tk/materialize.min.css">
    <link rel="stylesheet" href="https://platinumos.tk/bootstrap.min.css">
    <title>Platinum OS</title>
    <meta name="description" content="Online operating system community.">
    <meta name="keywords" content="platinum,os,operating,system,online,community">
    <meta property="og:image" content="https://i.imgur.com/Ram0iX4.png">
    <meta name="theme-color" content="#d2d256">
    <link rel="icon" href="https://i.imgur.com/Ram0iX4.png">
  </head>
  <body>
    <main>
        <br>
        <br>
        <br>
        <br>
        <center>
          <div class="container">
            <div class="row" id="user-login">
              <div class="col">
                <h1 id="user-login-username">Error</h1>
                <div class="input-field">
                  <input id="user-login-password" type="password" class="validate">
                  <label for="user-login-password">Password</label>
                </div>
                <a class="waves-effect waves-light btn-large accent-bg" href="javascript:login();">LOGIN</a>
              </div>
              <div class="col">
                <img id="user-login-picture" src="https://i.imgur.com/lyfqJEQ.png" width="225px" height="225px">
              </div>
            </div>
          </div>
        </center>

        <center id="loading">
          <div class="loading-screen">
            <div class="loading-content">
              <h1>Loading...</h1>
              <br>
              <div class="progress" style="width:60%;">
                <div class="indeterminate"></div>
              </div>
              <br>
              <p>Not loading? ribdev.software@gmail.com</p>
            </div>
          </div>
        </center>
    </main>
    <footer>
      
    </footer>
    
    <script src="https://platinumos.tk/jquery-3.5.1.js"></script>
    <script src="https://platinumos.tk/materialize.min.js"></script>
    <script>
      var accent_bg = "#d2d256";
      var url = new URL(window.location.href);
      var username = url.searchParams.get("u");
      
      function update_theme(){
        document.querySelectorAll(".accent-bg").forEach(function(abg){
          abg.style.setProperty("background-color",accent_bg,"important");
        });
      }
      
      function fadeOutLoadStart() {
        var fadeTarget = document.getElementById("loading");
        var fadeEffect = setInterval(function(){
          if (!fadeTarget.style.opacity)
              fadeTarget.style.opacity = 1;
          if (fadeTarget.style.opacity > 0)
              fadeTarget.style.opacity -= 0.1;
          else {
            fadeTarget.remove();
            clearInterval(fadeEffect);
          }
        },50);
      }
      
      function login(){
        var pw = document.getElementById("user-login-password").value;
        if (pw.value != atob(JSON.parse(localStorage.getItem("user-" + username))[1]))
          pw.classList.add("invalid");
        else {
          if (pw.classList.contains("invalid"))
            pw.classList.remove("invalid");
          window.location.href = "https://platinumos.tk/?u=" + username + "&p=" + pw;
        }
      }
      
      $(document).ready(function(){        
        document.body.style.backgroundImage = "url(https://i.imgur.com/0GqXjvZ.jpg)";
        
        console.log("Updated background.");
        
        fadeOutLoadStart();
        
        console.log("Faded out loading screen.")
      });

      function load_user(){
        var user = JSON.parse(localStorage.getItem("user-" + username));
        document.getElementById("user-login-username").innerHTML = user[0];
        document.getElementById("user-login-picture").src = user[2];
      }

      update_theme();
      load_user();
    </script>
  </body>
</html>
<style>
  body {
    background-repeat: no-repeat;
    background-size: cover;
    background-position: center center;
    overflow: hidden;
  }
  
  #user-login-username {
    color: white;
    text-shadow: 2px 2px 8px black;
  }
</style>
